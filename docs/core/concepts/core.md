# –ö–æ–Ω—Ü–µ–ø—Ç—ã —è–¥—Ä–∞ ClearMethod

> **–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ç—ã, —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ –æ—Å–Ω–æ–≤—É –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏**

---

## 1. AGENT

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ò–ò-–∞–≥–µ–Ω—Ç–∞ –∏ –µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –æ–∫–Ω–æ.

**–°–≤–æ–π—Å—Ç–≤–∞**:
- `model: string` - –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ (gpt-4, claude-sonnet-4, etc)
- `total_tokens: number` - —Ä–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –æ–∫–Ω–∞ (128K, 200K, etc)
- `used_tokens: number` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏

**–ó–∞—á–µ–º –Ω—É–∂–µ–Ω**: 
- –°–∞–º–æ–æ—Å–æ–∑–Ω–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ –æ —Å–≤–æ–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (–∫–æ–≥–¥–∞ –¥–µ–ª–∞—Ç—å reset)
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–¥ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**:
```yaml
# –ê–≥–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–≤–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
- if: AGENT.used_tokens > 0.8 * AGENT.total_tokens
  then: 
    - warn: "–ö–æ–Ω—Ç–µ–∫—Å—Ç –±–ª–∏–∑–æ–∫ –∫ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—é, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Context Reset"
```

---

## 2. TASK

**–¢–∏–ø**: –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–æ–Ω—Ü–µ–ø—Ç (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–∞–¥–∞—á–∞–º–∏. –ó–∞–¥–∞—á–∞ - —ç—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –ø–æ –≥—Ä–∞—Ñ—É workflow, –Ω–∞–∫–∞–ø–ª–∏–≤–∞—è –¥–∞–Ω–Ω—ã–µ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

**–§–∏–ª–æ—Å–æ—Ñ–∏—è**: TASK - —ç—Ç–æ **–∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è**. –û–Ω –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç "—á—Ç–æ" –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Å –∑–∞–¥–∞—á–µ–π, –Ω–æ –Ω–µ "–∫–∞–∫" —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –ø–∞–∫–µ—Ç–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, FILE_TASK).

### –°–≤–æ–π—Å—Ç–≤–∞ (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)

- `id: string` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, TASK-123)
- `title: string` - –∫—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
- `content: text` - –æ–ø–∏—Å–∞–Ω–∏–µ/—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
- `creator: string` - –∫—Ç–æ —Å–æ–∑–¥–∞–ª
- `created_at: datetime` - –∫–æ–≥–¥–∞ —Å–æ–∑–¥–∞–Ω–∞
- `last_updated_at: datetime` - –ø–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- `last_updater: string` - –∫—Ç–æ –æ–±–Ω–æ–≤–∏–ª
- `workflow: string` - id —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "feature")
- `status: string` - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ workflow (–Ω–∞–ø—Ä–∏–º–µ—Ä, "designing")

### –ú–µ—Ç–æ–¥—ã (—Å–∏–≥–Ω–∞—Ç—É—Ä—ã)

**–í–ê–ñ–ù–û**: –≠—Ç–æ —Ç–æ–ª—å–∫–æ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –º–µ—Ç–æ–¥–æ–≤. –†–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –ø–∞–∫–µ—Ç–∞.

- `create(id, title, content, creator, workflow) ‚Üí void` - —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
- `get_state() ‚Üí string` - –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- `set_state(state) ‚Üí void` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- `get_property(name) ‚Üí value` - –ø–æ–ª—É—á–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–æ
- `set_property(name, value) ‚Üí void` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–æ
- `log(entry) ‚Üí void` - –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –∂—É—Ä–Ω–∞–ª
- `get_log() ‚Üí array` - –ø–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é

### –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏

TASK - —ç—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

- **FILE_TASK** (–¥–ª—è MVP) - —Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (—Å–º. [extensions.md](extensions.md#file_task-–¥–ª—è-mvp))
- **DATABASE_TASK** (planned) - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
- **MCP_TASK** (planned) - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Ç—Ä–µ–∫–µ—Ä–∞–º–∏

### –ö–∞–∫ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è?

–ü—Ä–∏ setup –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é TASK. –í `config.yml` –ø—Ä–æ–µ–∫—Ç–∞:

```yaml
extensions:
  active:
    - file-task  # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è TASK

  task_implementation: file-task
```

–ê–≥–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –º–µ—Ç–æ–¥–æ–≤ TASK.

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```yaml
# –í –∫–æ–º–∞–Ω–¥–∞—Ö –∏ workflow –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è TASK
execute:
  - do: TASK.create("TASK-123", "Add notifications", "User story: ...", "andrey", "feature")
  - do: TASK.set_property("priority", "high")
  - do: TASK.log("Task created and initialized")

# –ê–≥–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç FILE_TASK.create(), FILE_TASK.set_property(), etc.
# –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
```

---

## 3. WORKFLOW

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å - –≥—Ä–∞—Ñ —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è –∑–∞–¥–∞—á.

**–§–∏–ª–æ—Å–æ—Ñ–∏—è**: Workflow - —ç—Ç–æ state machine. –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω workflow, –∫–∞–∂–¥–∞—è —Ö—Ä–∞–Ω–∏—Ç —Å–≤–æ–µ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è**: 
```
Task —Ö—Ä–∞–Ω–∏—Ç: "–Ø –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ X"
Workflow –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç: "–°–æ—Å—Ç–æ—è–Ω–∏–µ X –æ–∑–Ω–∞—á–∞–µ—Ç –¥–µ–ª–∞—Ç—å A, B, C"
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —É–∑–ª–∞ (—Å–æ—Å—Ç–æ—è–Ω–∏—è)

–ö–∞–∂–¥—ã–π —É–∑–µ–ª workflow –∏–º–µ–µ—Ç:
- `status: string` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "designing")
- `title: string` - —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
- `preconditions: array` - —É—Å–ª–æ–≤–∏—è –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- `postconditions: array` - —É—Å–ª–æ–≤–∏—è –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `execute: array` - –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —ç—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏

### –ü—Ä–∏–Ω—Ü–∏–ø –∏–∑–æ–ª—è—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π

**–í–ê–ñ–ù–û**: 
- –°–æ—Å—Ç–æ—è–Ω–∏—è –Ω–µ –∑–Ω–∞—é—Ç –¥—Ä—É–≥ –æ –¥—Ä—É–≥–µ –Ω–∞–ø—Ä—è–º—É—é
- –ù–µ–ª—å–∑—è –ø—Ä–æ–≤–µ—Ä—è—Ç—å "—è –ø–æ—Å–ª–µ designing?" –∏–ª–∏ "–ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±—ã–ª–æ X"
- –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è **–∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–∞–∫—Ç** - —Å–≤–æ–π—Å—Ç–≤–∞ –∑–∞–¥–∞—á–∏
- –ö–∞–∂–¥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–≤–æ–π—Å—Ç–≤–∞, —Å–ª–µ–¥—É—é—â–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∏—Ö

**–ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–∏**:
```yaml
# –°–æ—Å—Ç–æ—è–Ω–∏–µ "designing" —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–≤–æ–π—Å—Ç–≤–æ
postconditions:
  - TASK.get_property("design_completed") == true

# –°–æ—Å—Ç–æ—è–Ω–∏–µ "implementing" –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–≤–æ–π—Å—Ç–≤–æ, –∞ –Ω–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
preconditions:
  - TASK.get_property("design_completed") == true
```

**–ü–æ—á–µ–º—É –∏–∑–æ–ª—è—Ü–∏—è –≤–∞–∂–Ω–∞**:
- –ö–æ–º–ø–æ–∑–∏—Ä—É–µ–º–æ—Å—Ç—å - —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö workflow
- –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å - –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ
- –ì–∏–±–∫–æ—Å—Ç—å - –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏–π –±–µ–∑ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏

### –¢–∏–ø—ã —É–∑–ª–æ–≤

1. **–û–±—ã—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** - –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã
2. **–ü–æ–¥–ø—Ä–æ—Ü–µ—Å—Å (sub-workflow)** - –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –Ω–∞–±–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏–π (—Å–º. [advanced.md](advanced.md#–ø–æ–¥–ø—Ä–æ—Ü–µ—Å—Å—ã))

### –ú–µ—Ç–æ–¥—ã

- `start(task_id)` - –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å workflow –¥–ª—è –∑–∞–¥–∞—á–∏
- `go(task_id, status)` - –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∑–∞–¥–∞—á—É –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–µ—Ä–µ—Ö–æ–¥–æ–≤)
- `next(task_id)` - –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é (–µ—Å–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ - –∑–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä)
- `goback(task_id)` - –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
- `rework(task_id)` - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- `finalize(task_id)` - –∑–∞–≤–µ—Ä—à–∏—Ç—å workflow

### –ì—Ä–∞—Ñ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Å–æ—Å—Ç–æ—è–Ω–∏–π. –ü–µ—Ä–µ—Ö–æ–¥—ã —Ä–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É —è–≤–Ω–æ —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ —É–∑–ª–∞–º–∏.

**–ü—Ä–∏–º–µ—Ä workflow** (SBD feature workflow):
```
START ‚Üí [creating] ‚Üí [analyzing] ‚Üí [designing] ‚Üí [planning] ‚Üí [implementing] ‚Üí [verifying] ‚Üí [completing] ‚Üí END
```

### –£—Å–ª–æ–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã

Guard conditions –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ workflow, –∞ –Ω–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö (—Å–æ–±–ª—é–¥–µ–Ω–∏–µ –∏–∑–æ–ª—è—Ü–∏–∏):

```yaml
# workflow.yml
transitions:
  - from: analyzing
    to: designing
    guard: TASK.get_property("complexity") == "high"
    
  - from: analyzing
    to: implementing  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º design –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á
    guard: TASK.get_property("complexity") == "trivial"
```

### –ü—Ä–∏–º–µ—Ä —É–∑–ª–∞

```yaml
status: designing
title: "Design Solution"
preconditions:
  - TASK.get_property("requirements_clear") == true
postconditions:
  - file_exists("design.md")
  - TASK.get_property("design_approved") == true
execute:
  - do: "Analyze requirements from specs.md"
  - do: "Create design.md with architecture decisions"
  - do: "Request design approval from user"
  - do: TASK.set_property("design_approved", user_response)
```

---

## 4. CONTEXT

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º –æ–∫–Ω–æ–º –∞–≥–µ–Ω—Ç–∞ - —á—Ç–æ –∏ –∫–æ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–∞—Ç—å.

**–§–∏–ª–æ—Å–æ—Ñ–∏—è**: –¢–æ–∫–µ–Ω—ã - —ç—Ç–æ –≤–∞–ª—é—Ç–∞. –ó–∞–≥—Ä—É–∂–∞–µ–º –º–∏–Ω–∏–º—É–º –Ω—É–∂–Ω–æ–≥–æ, –≤ –Ω—É–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç.

**–ú–µ—Ç–æ–¥—ã**:
- `prime()` - –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (–ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –Ω–æ–≤–æ–≥–æ —á–∞—Ç–∞)
- `load(context_info)` - –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç priming

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–π —á–∞—Ç
2. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `/cm-prime` (–≤—Ä—É—á–Ω—É—é –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
3. –ß–∏—Ç–∞–µ—Ç—Å—è —Ñ–∞–π–ª `.cm/priming.yml`
4. –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ primers (–¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
5. –ê–≥–µ–Ω—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ —Å –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –ø—Ä–æ–µ–∫—Ç–∞

**–ü—Ä–∏–º–µ—Ä priming.yml**:
```yaml
primers:
  core:
    - .cm/core/primer.md
    - .cm/core/commands.md
  project:
    - .cm/context/architecture.md
    - .cm/context/tech-stack.md
  extensions:
    - .cm/packages/file-task/primer.md
```

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**:
```yaml
execute:
  - do: CONTEXT.prime()  # –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
  - do: CONTEXT.load("module:authentication")  # –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –º–æ–¥—É–ª—è
```

---

## 5. EVENT

**–¢–∏–ø**: –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–æ–Ω—Ü–µ–ø—Ç (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –º–µ–∂–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏. –°–æ–±—ã—Ç–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–∞–∫–µ—Ç–∞–º —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–µ–∑ –ø—Ä—è–º—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

**–§–∏–ª–æ—Å–æ—Ñ–∏—è**: –°–ª–∞–±–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å (loose coupling). –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ –∑–Ω–∞—é—Ç –¥—Ä—É–≥ –æ –¥—Ä—É–≥–µ –Ω–∞–ø—Ä—è–º—É—é, –Ω–æ –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∞–∫–µ—Ç–∞–º —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –∏ –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è/—É–¥–∞–ª—è—Ç—å—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–¥–∞.

### –ú–µ—Ç–æ–¥—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

```yaml
emit:
  description: –≠–º–∏—Ç–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º —Ç–∏–ø–æ–º –∏ –¥–∞–Ω–Ω—ã–º–∏
  params:
    - event_type: string  # "task.created", "workflow.stage_completed"
    - payload: object     # –î–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
    - sync: boolean       # –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ (true) –∏–ª–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
  returns:
    - event_id: string
    - handlers_executed: number
    - duration_ms: number

subscribe:
  description: –ü–æ–¥–ø–∏—Å–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è
  params:
    - event_type: string    # –¢–∏–ø —Å–æ–±—ã—Ç–∏—è –∏–ª–∏ wildcard "task.*"
    - extension: string     # –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ, –≤–ª–∞–¥–µ—é—â–µ–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º
    - handler: string       # –ü—É—Ç—å –∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É
    - filter: object        # –£—Å–ª–æ–≤–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    - priority: number      # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (1-200+)
  returns:
    - subscription_id: string

unsubscribe:
  description: –û—Ç–ø–∏—Å–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
  params:
    - subscription_id: string
  returns:
    - success: boolean

get_history:
  description: –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–æ–±—ã—Ç–∏–π
  params:
    - task_id: string       # –§–∏–ª—å—Ç—Ä –ø–æ –∑–∞–¥–∞—á–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    - event_type: string    # –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    - limit: number         # –ú–∞–∫—Å–∏–º—É–º —Å–æ–±—ã—Ç–∏–π
  returns:
    - events: array         # –ú–∞—Å—Å–∏–≤ —Å–æ–±—ã—Ç–∏–π

list_subscriptions:
  description: –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
  params:
    - event_type: string    # –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    - extension: string     # –§–∏–ª—å—Ç—Ä –ø–æ –ø–∞–∫–µ—Ç—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  returns:
    - subscriptions: array
```

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

#### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–¥–∞—á–∏
- `task.created` - –∑–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞
- `task.updated` - –∑–∞–¥–∞—á–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- `task.deleted` - –∑–∞–¥–∞—á–∞ —É–¥–∞–ª–µ–Ω–∞
- `task.property_changed` - —Å–≤–æ–π—Å—Ç–≤–æ –∏–∑–º–µ–Ω–µ–Ω–æ
- `task.state_changed` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–æ
- `task.stage_started` - –Ω–∞—á–∞–ª–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ç–∞–¥–∏–∏
- `task.stage_completed` - —Å—Ç–∞–¥–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- `task.workflow_started` - workflow –∑–∞–ø—É—â–µ–Ω
- `task.workflow_completed` - workflow –∑–∞–≤–µ—Ä—à–µ–Ω
- `task.workflow_failed` - workflow –ø—Ä–æ–≤–∞–ª–µ–Ω

#### –ö–∞—á–µ—Å—Ç–≤–æ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- `quality.gate_checked` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- `quality.gate_passed` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞
- `quality.gate_failed` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–≤–∞–ª–µ–Ω–∞
- `validation.precondition_checked` - precondition –ø—Ä–æ–≤–µ—Ä–µ–Ω
- `validation.postcondition_checked` - postcondition –ø—Ä–æ–≤–µ—Ä–µ–Ω

#### VCS –æ–ø–µ—Ä–∞—Ü–∏–∏
- `vcs.branch_created` - –≤–µ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∞
- `vcs.commit_created` - –∫–æ–º–º–∏—Ç —Å–æ–∑–¥–∞–Ω
- `vcs.push_completed` - push –≤—ã–ø–æ–ª–Ω–µ–Ω
- `vcs.pr_created` - PR —Å–æ–∑–¥–∞–Ω

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- `context.loaded` - –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–≥—Ä—É–∂–µ–Ω
- `context.updated` - –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω
- `context.file_added` - —Ñ–∞–π–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç

#### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- `extension.registered` - –ø–∞–∫–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ
- `command.executed` - –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- `error.occurred` - –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Å–æ–±—ã—Ç–∏—è

**1. –≠–º–∏—Å—Å–∏—è —Å–æ–±—ã—Ç–∏—è**
```yaml
# –í –ª—é–±–æ–º CML —Ñ–∞–π–ª–µ (workflow state, –º–µ—Ç–æ–¥, –∫–æ–º–∞–Ω–¥–∞)
- EVENT.emit("task.stage_started", {
    task_id: "FEAT-001",
    stage: "designing",
    timestamp: "2025-11-25T10:30:00Z"
  })
```

**2. –†–µ–∑–æ–ª–≤–∏–Ω–≥ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ**
- –ê–≥–µ–Ω—Ç —Ä–µ–∑–æ–ª–≤–∏—Ç `EVENT` ‚Üí `project.yml` ‚Üí `basic-events.BASIC_EVENT`
- –°–æ–±—ã—Ç–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `.cm/events/events.yml`
- –ß–∏—Ç–∞—é—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∏ –∏–∑ `.cm/events/subscriptions.yml`

**3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤**
- –ù–∞—Ö–æ–¥—è—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∏ —Å matching event_type
- –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä—ã (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã)
- –°–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É (–º–µ–Ω—å—à–µ = —Ä–∞–Ω—å—à–µ)

**4. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤**
```yaml
# .cm/packages/git-vcs/handlers/on_task_created.yml
name: on_task_created
params:
  - name: event
  - name: payload

instructions:
  - let: branch_name = "feature/{payload.task_id}"
  - VCS.create_branch(payload.task_id, branch_name)
  - TASK.log(payload.task_id, "Branch created: {branch_name}")
  
  # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –º–æ–∂–µ—Ç —ç–º–∏—Ç–∏—Ç—å –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è (–∫–∞—Å–∫–∞–¥)
  - EVENT.emit("vcs.branch_created", {
      task_id: payload.task_id,
      branch: branch_name
    })
```

**5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**
```yaml
# .cm/events/events.yml
- id: evt-001
  type: task.stage_started
  timestamp: 2025-11-25T10:30:00Z
  payload:
    task_id: FEAT-001
    stage: designing
  handlers_executed:
    - subscription_id: sub-001
      extension: git-vcs
      handler: handlers/on_stage_started
      status: success
      duration_ms: 156
    - subscription_id: sub-002
      extension: qa-gates
      handler: handlers/validate_stage
      status: success
      duration_ms: 89
  duration_ms: 245
  status: completed
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**: `basic-events.BASIC_EVENT` (—Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
- –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã
- –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤ (–º–∞–∫—Å. –≥–ª—É–±–∏–Ω–∞ 10)
- –ò–∑–æ–ª—è—Ü–∏—è –æ—à–∏–±–æ–∫ (—Å–±–æ–π –æ–¥–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥—Ä—É–≥–∏–µ)

**–í–æ–∑–º–æ–∂–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã** (future):
- `redis-events` - pub/sub —á–µ—Ä–µ–∑ Redis
- `postgres-events` - LISTEN/NOTIFY –≤ PostgreSQL
- `kafka-events` - Apache Kafka –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–æ–±—ã—Ç–∏–π–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

‚úÖ **–°–ª–∞–±–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å**: –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –Ω–µ –∑–∞–≤–∏—Å—è—Ç –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞
‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
‚úÖ **–ê—É–¥–∏—Ç**: –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å**: –§–∏–ª—å—Ç—Ä—ã –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —Ç–æ—á–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º
‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –ø–æ–¥–º–µ–Ω–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –¥–ª—è —Ç–µ—Å—Ç–æ–≤

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è:**
- –ò–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è (—Å–æ–∑–¥–∞–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ)
- –ó–Ω–∞—á–∏–º—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π (–∫–æ–º–º–∏—Ç, PR, –¥–µ–ø–ª–æ–π)
- –¢–æ—á–µ–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏
- Quality gates –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

‚ùå **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è:**
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —à–∞–≥–æ–≤ –ª–æ–≥–∏–∫–∏
- –ß–∞—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (–∫–∞–∂–¥–æ–µ —á—Ç–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞)
- –ü—Ä–∏–≤–∞—Ç–Ω—ã—Ö –¥–µ—Ç–∞–ª–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤)

**–ü–æ–¥—Ä–æ–±–Ω–µ–µ**: –°–º. [events.md](events.md) - –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å–∏—Å—Ç–µ–º–µ —Å–æ–±—ã—Ç–∏–π

---

## –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤ —è–¥—Ä–∞

### –¢–∏–ø–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π: –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ –∑–∞–¥–∞—á–µ–π

```yaml
# –®–∞–≥ 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞—á—É
User: "/cm-start feature TASK-123"

# –®–∞–≥ 2: –ê–≥–µ–Ω—Ç –∏—Å–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—É start
- CONTEXT.prime()  # –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç
- WORKFLOW.start("TASK-123")  # –ó–∞–ø—É—Å—Ç–∏—Ç—å workflow

# –í–Ω—É—Ç—Ä–∏ WORKFLOW.start():
  - TASK.create("TASK-123", "feature", ...)
  
  # ‚ö° –≠–º–∏—Ç–∏—Ä—É–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ
  - EVENT.emit("task.created", {
      task_id: "TASK-123",
      workflow: "feature",
      title: "Add user authentication"
    })
  
  # üì° –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è:
  #   - git-vcs ‚Üí —Å–æ–∑–¥–∞–µ—Ç –≤–µ—Ç–∫—É feature/TASK-123
  #   - notifications ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Slack
  #   - qa-gates ‚Üí —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç quality checklist
  
  - TASK.set_state("creating")  # –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  
# –®–∞–≥ 3: Workflow –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ –ø–µ—Ä–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ "creating"
# –ß–∏—Ç–∞–µ—Ç—Å—è —Ñ–∞–π–ª states/creating.yml:
  preconditions: []  # –ù–µ—Ç —É—Å–ª–æ–≤–∏–π –¥–ª—è —Å—Ç–∞—Ä—Ç–∞
  
  instructions:
    # ‚ö° –°–æ–±—ã—Ç–∏–µ –Ω–∞—á–∞–ª–∞ —Å—Ç–∞–¥–∏–∏
    - EVENT.emit("task.stage_started", {
        task_id: "TASK-123",
        stage: "creating"
      })
    
    - info: "Request task specifications from user"
    - write: "specs.md"
      content: user_input
    - TASK.set_property("specs_ready", true)
    
    # ‚ö° –°–æ–±—ã—Ç–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å—Ç–∞–¥–∏–∏
    - EVENT.emit("task.stage_completed", {
        task_id: "TASK-123",
        stage: "creating"
      })
    
    # üì° qa-gates –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
  
  postconditions:
    - TASK.get_property("specs_ready") == true

# –®–∞–≥ 4: –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
User: "/cm-next"

- WORKFLOW.next("TASK-123")

# –í–Ω—É—Ç—Ä–∏ WORKFLOW.next():
  - check: postconditions —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã?
  
  # ‚ö° –°–æ–±—ã—Ç–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∞
  - EVENT.emit("task.state_changed", {
      task_id: "TASK-123",
      from: "creating",
      to: "designing"
    })
  
  - TASK.set_state("designing")  # –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É
  - read: states/designing.yml
  - execute: –∫–æ–º–∞–Ω–¥—ã –∏–∑ designing.yml

# ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ –ø–æ –≤—Å–µ–º—É workflow

# –®–∞–≥ 5: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ workflow
- EVENT.emit("task.workflow_completed", {
    task_id: "TASK-123",
    workflow: "feature",
    duration_ms: 3600000
  })

# üì° –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ä–µ–∞–≥–∏—Ä—É—é—Ç:
#   - git-vcs ‚Üí —Å–æ–∑–¥–∞–µ—Ç PR
#   - notifications ‚Üí —É–≤–µ–¥–æ–º–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
#   - analytics ‚Üí –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–æ–±—ã—Ç–∏–π–Ω–æ–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏

**–ë–µ–∑ —Å–æ–±—ã—Ç–∏–π** (—Å—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥):
```yaml
# states/creating.yml
- TASK.set_property("stage", "creating")
# git-vcs –Ω–µ –∑–Ω–∞–µ—Ç –æ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ –Ω–æ–≤—É—é —Å—Ç–∞–¥–∏—é
# qa-gates –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
# —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –∫–∞–∂–¥—É—é —Å—Ç–∞–¥–∏—é –≤—Ä—É—á–Ω—É—é
```

**–° —Å–æ–±—ã—Ç–∏—è–º–∏** (–Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥):
```yaml
# states/creating.yml
- EVENT.emit("task.stage_started", {stage: "creating"})
- TASK.set_property("stage", "creating")

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤—Å–µ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:
# - git-vcs —Å–æ–∑–¥–∞–µ—Ç –≤–µ—Ç–∫—É
# - qa-gates –ø—Ä–æ–≤–µ—Ä—è–µ—Ç preconditions
# - notifications –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
# - analytics –ª–æ–≥–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫—É
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –†–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ, –∏—Ö –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å/—É–¥–∞–ª—è—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è workflow states.

---

## –ú–µ—Ö–∞–Ω–∏–∑–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤

### –ö–∞–∫ –ò–ò-–∞–≥–µ–Ω—Ç –∏—Å–ø–æ–ª–Ω—è–µ—Ç –º–µ—Ç–æ–¥—ã?

**–ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å**:

1. **–ß—Ç–µ–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–∞**
   - –ê–≥–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç YAML-–æ–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∞
   - –ü–∞—Ä—Å–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, preconditions, execute, postconditions)

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç preconditions
   - –ï—Å–ª–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã ‚Üí —Å–æ–æ–±—â–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

3. **–ü–æ—à–∞–≥–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**
   - –ß–∏—Ç–∞–µ—Ç –∫–∞–∂–¥—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ `execute`
   - –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ (—Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª, –≤—ã–∑–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥, –∑–∞–ø—Ä–æ—Å–∏—Ç—å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

4. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—ã—Ö–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç postconditions
   - –ï—Å–ª–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã ‚Üí —Å–æ–æ–±—â–∞–µ—Ç –æ–± –æ—à–∏–±–∫–µ (–≤ MVP - –±–µ–∑ –∞–≤—Ç–æ–æ—Ç–∫–∞—Ç–∞)

5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –∂—É—Ä–Ω–∞–ª –∑–∞–¥–∞—á–∏

**–ü—Ä–∏–º–µ—Ä –º–µ—Ç–æ–¥–∞**:
```yaml
name: TASK.create
parameters:
  - name: task_id
    type: string
    required: true
  - name: workflow_id
    type: string
    required: true
  - name: specs
    type: text
    required: false
preconditions:
  - not exists(task_id)  # –ó–∞–¥–∞—á–∏ —Å —Ç–∞–∫–∏–º ID –µ—â–µ –Ω–µ—Ç
execute:
  - let: TASK_FOLDER = "<PROJECT_ROOT>/.cm/tasks/<task_id>"
  - do: "Create folder <TASK_FOLDER>"
  - do: "Create file <TASK_FOLDER>/status.yml from template"
  - do: "Set status.yml fields: id=<task_id>, workflow=<workflow_id>"
  - do: "Create file <TASK_FOLDER>/specs.md"
  - if: specs is not empty
    then:
      - do: "Write <specs> to specs.md"
  - do: TASK.log("Task created at " + current_datetime())
postconditions:
  - exists("<TASK_FOLDER>/status.yml")
  - exists("<TASK_FOLDER>/specs.md")
```

---

**–°–º. —Ç–∞–∫–∂–µ:**
- [../concepts.md](../concepts.md) - –û–±–∑–æ—Ä –∏ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤
- [extensions.md](extensions.md) - –ö–æ–Ω—Ü–µ–ø—Ç—ã –ø–∞–∫–µ—Ç–æ–≤
- [advanced.md](advanced.md) - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- [mvp-decisions.md](mvp-decisions.md) - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è MVP

